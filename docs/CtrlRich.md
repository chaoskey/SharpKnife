# Ctrl功能增强

> 本工具是[SharpKnife(利刃)](../README.md)效率工具库的成员
>
> 20211218, 将自写简陋截图贴图功能，改成调用Snipaste软件实现，功能突然变强大（我这是投机取巧哦！）。

![](../images/CtrlRich.jpg)


## 启动

> 建议配置成开机启动

```powershell
git clone https://github.com/chaoskey/SharpKnife.git
# 需要先安装AutoHotkey
autohotkey.exe CtrlRich.ahk

# 或者  下载 https://github.com/chaoskey/SharpKnife/releases
CtrlRich.exe
```

## 基本说明

所有“Ctrl+单字符”Ctrl松开后的命令的系统功能不变。

所有“Ctrl+多字符”命令都当成增强命令，已定制的命令有动作，否则无动作。

在Ctrl按下后，单字符”或“多字符”的每个字符都要求快速单击，否则一个字符可能会出现多个重复字符。

【控制命令】Ctrl松开前可能执行的命令，所有的控制命令都可反复敲击

【功能命令】Ctrl松开后可能执行的命令。

从基本的Ctrl-X-C-V的"剪切-复制-粘贴"命令开始增强。

## 增加 “剪切板历史记录-浏览-删除” 的功能

> 相关命令都是基于Ctrl-V增强的“控制命令”，Ctrl松开前执行。

- `Ctrl-VA` 删除所有剪切板历史记录（特别标记的除外）

- `Ctrl-VS` 浏览下一条历史记录

- `Ctrl-VD` 删除当前历史记录（包括特别标记的）

- `Ctrl-VF` 浏览上一条历史记录

注意: 

1. Ctrl松开后将，执行**系统粘贴**功能（Ctrl-V）； Ctrl松开前再补敲一个字符V, Ctrl松开后将，执行**贴图**功能（Ctrl-VV），可以将文字，位图，图片文件... 直接贴图到桌面。
2. 在Ctrl松开前，`Ctrl-VA = Ctrl-VVA` , `Ctrl-VS = Ctrl-VVS`, `Ctrl-VD = Ctrl-VVD`, `Ctrl-VF = Ctrl-VVF`；  区别在Ctrl松开后，前者代表系统粘贴，后者代表贴图。 

## 增加“剪切板历史记录的搜索-标记”功能

> 这是一个“功能命令”，Ctrl松开后执行。

- 敲击Ctrl+SS 弹出搜索框-输入-回车进行搜索。

如果有匹配的内容，则弹出列表选择粘贴。

我假定凡是经过搜索粘贴的内容都是重要的值得特别标记的内容。

凡是特别标记的内容，不能被控制命令Ctrl-VA删除，只能被控制命令Ctrl-VD选择删除。

## 增加截图的复制粘贴功能  

> 这是一个类似系统复制粘贴的“功能命令”，Ctrl松开后执行。
>
> 20211218, 改成调用Snipaste的方式实现截图和贴图

- Ctrl + CC  鼠标选择截图 或 点击窗口截图  到 剪切板

- Ctrl + VV  剪切板贴图, 可以将位图，文字, 图片文件，贴图

## ~~增加桌面贴图管理~~

> 20211218, 改成调用Snipaste的方式实现截图和贴图，所以这个简陋的管理也删除
>
> ~~这是类似剪切板历史记录管理的“控制命令”，Ctrl松开前执行。~~

- ~~Ctrl + VVA 删除全部桌面贴图~~

- ~~Ctrl + VVS 下一个桌面贴图闪烁~~

- ~~Ctrl + VVD 删除当前桌面贴图~~

- ~~Ctrl + VVF 上一个桌面贴图闪烁~~

## 增加剪切板内容编辑功能

> 这是一个“功能命令”，Ctrl松开后执行。

- Ctrl + VE 弹出编辑框，修改后按Ctrl-S保存并粘贴

可以在Ctrl松开前，先删除-浏览，最后敲击E, 松开即弹出当前剪切板的编辑框。 【比如: Ctrl+VSDSE = Ctrl+VE】

## 增加多标签支持

- 【默认】 在Ctrl+SS搜索粘贴，自动添加★标签

- 在Ctrl+VE弹出的编辑框中，添加前缀`[标签名]`，可对当前clip进行标记或标记改名；删除前缀`[标签名]`，相当标记删除。

- 在Ctrl+VE弹出的编辑框中，将对标记中的*转义成★， 比如`[*]`转义成`[★]`

## 关于控制命令的说明

- 目前控制命令只在Ctrl+V后，在Ctrl保持按下的状态下执行

- Ctrl一旦松开，所有的控制命令字符将全部消失，比如:   Ctrl+VSSFFDD = Ctrl+V ,所有松开后会执行系统粘贴功能。

- 一般而言Ctrl+V 执行控制命令并Ctrl松开后会执行系统粘贴或位图粘贴

- 如果希望上述控制命令并Ctrl松开后不执行粘贴功能，可以追加一个特殊的字符X， 比如: Ctrl+VSSX = Ctrl+VX ，这个命令未定制，所以无任何动作。

- 控制命令后还可以追加字符V然后Ctrl松开，表示将当前剪切板（可能是文本，位图，图片文件）直接贴图。比如:   Ctrl+VSSFFDDV = Ctrl+VV ,松开后执行贴图。

